#! /usr/bin/env python2

import sys

sys.path.append(sys.path[0] + '/../lib')
sys.path.append(sys.path[0] + '/../etc')
sys.path.append(sys.path[0] + '/../lib/importedLibs')

from optparse import OptionParser
import gateway

usage =  "%prog pathConfigFile\n" \
         "       Un receiver reçoit les bulletins par une connection réseau et les\n" \
         "       écrits sur le disque. Le fichier de configuration doit être dûement\n" \
	 "       remplit pour que le programme fonctionne correctement."

parser = OptionParser(usage)
options,args = parser.parse_args()

if len(args) > 1:
	parser.error("trop d'arguments fournis")
elif len(args) == 0:
	parser.error("aucun fichier de config fourni")

# Chargement de la config pour savoir le type de protocole
# FIXME: Vérifier que typeProtocole est défini
config = gateway.gateway.loadConfig(args[0])

if config.typeProcotole == 'AM':

	import receiverAm
	unGateway = receiverAm.receiverAm(args[0])

elif config.typeProcotole == 'WMO':

	# FIXME à implanter
	pass

else:
	raise Exception('Type de protocole non reconnu')	# FIXME


